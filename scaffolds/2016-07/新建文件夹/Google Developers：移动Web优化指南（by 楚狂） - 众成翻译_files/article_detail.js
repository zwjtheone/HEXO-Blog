(function(e){function n(r){if(t[r])return t[r].exports;var i=t[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,n),i.loaded=!0,i.exports}var t={};return n.m=e,n.c=t,n.p="",n(0)})([function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),s=r(i),o=n(1);o.init($(".user-r .avatar")),o.run();var u=n(3);u.init(),$(".js-claim").click(function(e){$(this).prop("disabled","disabled");var t=$(this).attr("data-id"),n=window.location.href,r=$(this).attr("data-letters");return s["default"].getInfo().then(function(e){e.errno!=0?(layer.msg("\u60a8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8bd5\uff01"),setTimeout(function(){location.href="/user/loginpage?rdurl="+encodeURIComponent(location.href)},1e3)):layer.confirm("\u8981\u8ba4\u9886\u8fd9\u7bc7\u6587\u7ae0\uff0c\u60a8\u5fc5\u987b\u540c\u610f\u5728"+(3+Math.ceil(r/300))+"\u5929\u5185\u5b8c\u6210\u7ffb\u8bd1\u3002\n                         \uff08\u5929\u6570\u8ba1\u7b97\u516c\u5f0f\u4e3a\uff1aMath.ceil(\u5355\u8bcd\u6570/300)+3\u3002\uff09\u672c\u6587\u7ea6"+r+"\u4e2a\u5355\u8bcd\u3002\n                          \u5982\u679c\u5230\u671f\u4e0d\u80fd\u5b8c\u6210\u7ffb\u8bd1\uff0c\u6211\u4eec\u6709\u6743\u64a4\u9500\u60a8\u8ba4\u9886\u7684\u8fd9\u7bc7\u6587\u7ae0\uff0c\u800c\u4e14\u4e0d\u8d1f\u8d23\u4fdd\u5b58\u60a8\u5df2\u7ecf\u7ffb\u8bd1\u7684\u90e8\u5206\u3002\n                          \u64a4\u9500\u8ba4\u9886\u65f6\uff0c\u9664\u4e86\u4f1a\u6263\u9664\u60a8\u56e0\u8ba4\u9886\u672c\u6587\u6240\u83b7\u5f97\u768420\u79ef\u5206\u5916\uff0c\u8fd8\u53ef\u80fd\u989d\u5916\u6263\u9664\u60a8\u7684\u66f4\u591a\u79ef\u5206\u3002\n                          \u4e00\u65e6\u60a8\u7684\u79ef\u5206\u4e3a\u8d1f\u503c\uff0c\u5c06\u53ef\u80fd\u88ab\u5c01\u53f7\u3002",{title:"\u90d1\u91cd\u63d0\u9192",closeBtn:0,icon:0,area:["400px","290px"],time:0,btn:["\u540c\u610f\uff0c\u4fdd\u8bc1\u5b8c\u6210\u4efb\u52a1","\u6211\u518d\u60f3\u60f3"],yes:function(n){layer.close(n),$.ajax({url:"/original/claim/",data:"id="+t}).then(function(e){e.errno==0||e.errno==1007?location.href="/translate/"+t:e.errno==1018?(layer.msg("\u60a8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8bd5\uff01"),setTimeout(function(){location.href="/user/loginpage"},1e3)):layer.msg(e.errmsg,{icon:2})})}})})}),$(".js-unclaim").click(function(e){$(this).prop("disabled","disabled");var t=window.location.href,n=$(this).attr("data-id"),r=$(this).attr("data-owner")||"",i=$(this).attr("data-admin")==1,s={id:n,owner:r},o="\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u5df2\u6709\u52b3\u52a8\u6210\u679c\u5e76\u6263\u966420\u79ef\u5206\uff0c\u8bf7\u4e09\u601d\u800c\u540e\u884c\u3002";if(i){var u=50+10*Math.floor($(this).attr("data-letters")/1e3);s.is_admin=i,o="\u6b64\u64cd\u4f5c\u5c06\u5220\u9664\u5df2\u6709\u52b3\u52a8\u6210\u679c\u5e76\u6263\u9664"+u+"\u79ef\u5206\uff0c\u8bf7\u4e09\u601d\u800c\u540e\u884c\u3002"}layer.confirm(o,{title:"\u5371\u9669\u8b66\u793a",closeBtn:0,icon:0,area:'["380px","160px"]',time:0,btn:["\u6211\u771f\u7684\u60f3\u597d\u4e86","\u51b2\u52a8\u662f\u9b54\u9b3c"],yes:function(n){layer.close(n),$.ajax({url:"/original/unclaim/",data:s}).then(function(e){e.errno==0||e.errno==1007?window.location.href=t:layer.msg(e.errmsg,{icon:2})})}})}),$(".js-translate").click(function(e){$(this).prop("disabled","disabled");var t=$(this).attr("data-id"),n=window.location.href;return location.href="/translate/"+t,!1}),$(".js-unpublish").click(function(e){$(this).prop("disabled","disabled");var t=$(this).attr("data-id"),n=30+10*Math.floor($(this).attr("data-letters")/1e3),r=window.location.href,i=$(this).attr("data-owner")||"";layer.confirm("\u6b64\u64cd\u4f5c\u5c06\u6263\u9664"+n+"\u79ef\u5206\uff0c\u60a8\u786e\u5b9a\u5417\uff1f",{title:"\u6e29\u99a8\u63d0\u793a",closeBtn:0,icon:3,time:0,btn:["\u6211\u786e\u5b9a","\u518d\u60f3\u60f3"],yes:function(n){layer.close(n),$.ajax({url:"/article/unpublish/",data:"id="+t+"&owner="+i}).then(function(e){e.errno==0||e.errno==1007?window.location.href=r:layer.msg(e.errmsg,{icon:2})})}})}),$(".js-edit").click(function(e){$(this).prop("disabled","disabled");var t=$(this).attr("data-id");window.location.href="/recommend/"+t}),$(".js-delete").click(function(e){$(this).prop("disabled","disabled");var t=$(this).attr("data-id"),n=$(this).attr("data-owner")||"",r=window.location.href;layer.confirm("\u6b64\u64cd\u4f5c\u5c06\u6263\u966410\u79ef\u5206\uff0c\u60a8\u786e\u5b9a\u8981\u5220\u9664\u5417\uff1f",{time:0,closeBtn:0,btn:["\u6211\u786e\u5b9a","\u518d\u60f3\u60f3"],yes:function(i){layer.close(i),$.ajax({url:"/original/delete/",data:"id="+t+"&owner="+n}).then(function(e){e.errno==0||e.errno==1007?window.location.href=r:layer.msg(e.errmsg,{icon:2})})}})}),$(".js-deleteuser").click(function(e){$(this).prop("disabled","disabled");var t=$(this).attr("data-id"),n=window.location.href;layer.confirm("\u60a8\u786e\u5b9a\u8981\u5220\u9664\u8fd9\u4e2a\u7528\u6237\uff1f",{title:"\u5371\u9669\u8b66\u793a",closeBtn:0,icon:0,time:0,btn:["\u6211\u786e\u5b9a","\u518d\u60f3\u60f3"],yes:function(r){layer.close(r),$.ajax({url:"/admin/deleteuser/",data:"id="+t}).then(function(e){e.errno==0||e.errno==1007?window.location.href=n:layer.msg(e.errmsg,{icon:2})})}})});var a=function(){$(".markdown-format").find("pre").addClass("prettyprint"),typeof prettyPrint!="undefined"&&prettyPrint()}();$(".js-show-toweekly").on("click",function(e){var t=$.Deferred(),n=$(e.target).attr("data-id");$.ajax({url:"/article/detail/?id="+n+"&ajax=1"}).then(function(e){var t=e.data.cates,n=e.data.article,r=t.map(function(e){return e.title}).join(",");layer.open({type:1,title:"\u5c06\u8bd1\u6587\u63a8\u8350\u5230\u300a\u5947\u821e\u5468\u520a\u300b",skin:"layui-layer-rim",area:["550px","430px"],content:'<div style="margin: 20px;">\n                        <div style="position:relative;text-align:center;">\n                            <img src="http://s0.qhimg.com/static/0bd609329e53768e/zcfy_logo_black999.svg" width="130" height="36" /> \n                            <img style="margin-left:20px;height:80px;" src="http://p6.qhimg.com/t019a998a1b366e334e.png"/>\n                        </div>\n                        <form class="ui-form" style="margin:20px 0;font-size:14px;">\n                            <table border="0" cellpadding="0" cellspacing="0" class="ui-tb ui-tb-form">\n                                <tr>\n                                    <th style="width:150px;">\u6587\u7ae0\u6807\u9898</th>\n                                    <td style="width:380px;">\n                                        <input type="text" name="title" value="'+n.title+'" class="ip-text" style="width:370px;"/>\n                                    </td>    \n                                </tr>\n                                <tr>\n                                    <th style="width:150px;">\u63a8\u8350\u7406\u7531</th>\n                                    <td style="width:380px;">\n                                        <textarea style="width:370px;height:100px;" name="description" type="text" maxlength="512" \n                                        placeholder="\u8bf7\u586b\u5199\u4e3a\u4ec0\u4e48\u63a8\u8350\u8fd9\u7bc7\u6587\u7ae0\u6216\u8005\u8be5\u6587\u7ae0\u7684\u7b80\u4ecb\uff0c512\u5b57\u5185\uff0c\u5141\u8bb8html">'+n.abstract+'...</textarea>\n                                    </td>    \n                                </tr>\n                                <tr>\n                                    <th style="width:150px;">\u5206\u7c7b</th>\n                                    <td style="width:380px;">\n                                         <input type="text" name="tags" value="'+r+'" class="ip-text" style="width:370px;"/>\n                                    </td>    \n                                </tr>\n                                <tr style="padding:10px 0;">\n                                    <th style="width:150px;"></th>\n                                    <td>\n                                        <input class="js-toweekly" type="button" value="\u597d\u4e86\uff0c\u5c31\u8fd9\u6837\uff01" class="ui-btn ui-btn-default" style="font-size:16px;"/>\n                                    </td>    \n                                </tr>\n                            </table>\n                            <input type="hidden" name="id" value="'+n.id+'"/>\n                        </form>\n                </div>'})})}),$("body").delegate(".js-toweekly","click",function(e){var t=$(this)[0].form,n=$(t).find("input[name=id]").val(),r=$(t).serialize();$(this).remove(),$.ajax({url:"/article/toweekly/",type:"POST",data:r}).then(function(e){layer.closeAll(),$(".js-show-toweekly").each(function(e,t){var r=$(t);r.attr("data-weekly")==n&&(r.parent().addClass("disabled"),r.unbind("click").text("\u5df2\u63a8\u8350\u5230\u5947\u821e\u5468\u520a"))});if(e.errno==0){layer.msg("\u597d\u68d2\uff0c\u63a8\u8350\u6210\u529f\u4e86\uff0c\u8d60\u90015\u79ef\u5206\uff01");var t=$(".jifen").text();t=parseInt(t.substring(3,t.indexOf("\u79ef\u5206")))+5,$(".jifen").text("\u5f53\u524d\u6709"+t+"\u79ef\u5206")}else layer.msg(e.errmsg,{icon:2})},function(e){console.log(e)})}),$(".js-tofirekylin").click(function(e){var t=$(e.target).attr("data-firekylin"),n=$(e.target).attr("data-id");layer.confirm("\u786e\u5b9a\u8981\u63a8\u9001\u5417\uff1f",{btn:["\u786e\u5b9a","\u518d\u7b49\u7b49"]},function(e){layer.closeAll(),$.ajax({url:"/article/tofirekylin",method:"post",data:{article_id:n,firekylin_id:t},dataType:"json"}).done(function(e){layer.closeAll();if(e.errno==0){var r="\u597d\u68d2\uff0c\u63a8\u9001\u6210\u529f\u4e86\uff01";if(e.errmsg=="firstpush"){r="\u597d\u68d2\uff0c\u63a8\u9001\u6210\u529f\u4e86\uff0c\u8d60\u90015\u79ef\u5206\uff01";var i=$(".jifen").text();i=parseInt(i.substring(3,i.indexOf("\u79ef\u5206")))+5,$(".jifen").text("\u5f53\u524d\u6709"+i+"\u79ef\u5206")}$(".js-tofirekylin").each(function(e,r){var i=$(r);i.attr("data-firekylin")==t&&i.attr("data-id")==n&&i.text("\u518d\u6b21\u63a8\u9001\u5230"+i.text().substring(i.text().indexOf("\u5230")+1))}),layer.msg(r)}else layer.msg(e.errmsg,{icon:2})}).fail(function(e){console.log(e)})},function(e){console.log("canceled")})}),$("#btn-report").on("click",function(e){e.preventDefault(),layer.open({type:1,title:"\u4e3e\u62a5",area:["300px","250px"],shift:2,content:'<div class="layer-report">\n                        <ul>\n                            <li><label><input type="radio" name="radio-report" checked /> \u5783\u573e</label></li>\n                            <li><label><input type="radio" name="radio-report" /> \u9a9a\u6270</label></li>\n                            <li><label><input type="radio" name="radio-report" /> \u4e0d\u5f53\u5185\u5bb9</label></li>\n                        </ul>\n                        <p class="cell-btn">\n                            <button type="submit" class="ui-btn ui-btn-default">\u63d0\u4ea4</button>\n                            <button type="reset" class="ui-btn ui-btn-default">\u53d6\u6d88</button>\n                        </p>\n                    </div>'})});var f=n(4),l=new f(".claim-meta .vote",{invalid:"disabled"},!0);$(".toggle-bilingual-reading").click(function(e){var t=$(e.target),n=$(".original"),r=$(".translation"),i=$("#doc-bd");n.toggleClass("open"),r.toggleClass("open"),$("#copyright").toggleClass("hide"),t.text()=="\u6253\u5f00\u53cc\u8bed\u5bf9\u7167\u9605\u8bfb"?function(){var e=function(n,r){var s=$(window).height()-t.outerHeight(!0)-$(".payeeQRCode div").outerHeight(!0)+25;n.height(s).width($(window).width()/2-50),r.height(s).width($(window).width()/2-50),i.width($(window).width())},s=function(t,n){var r=$("div",t).height(),i=$("div",n).height(),s=0;n.hover(function(){n.on("scroll",function(e){s=n.scrollTop()/i,t.scrollTop(s*r)}),t.unbind("scroll")})};t.text("\u5173\u95ed\u53cc\u8bed\u5bf9\u7167\u9605\u8bfb"),i.width($(window).width()).css({padding:0}),$(".headline").css({margin:"0",padding:"15"}),$(".editormd-preview-container").width("100%"),$(document).scrollTop(t.offset().top-15),e(n,r),$(window).on("resize",function(t){e(n,r)}),s(n,r),s(r,n),$(document.body).css({overflow:"hidden","overflow-y":"hidden"}),$(".addition-item").hide()}():(t.text("\u6253\u5f00\u53cc\u8bed\u5bf9\u7167\u9605\u8bfb"),i.width("").css({padding:""}),$(".headline").css({margin:"",padding:""}),$(".editormd-preview-container").width(""),n.css("height",""),r.css("height",""),n.unbind("scroll"),r.unbind("scroll"),$(window).unbind("resize"),$(document.body).css({overflow:"auto","overflow-y":"auto"}),$(".addition-item").show())}),$(".toggle-unilingual-reading").click(function(e){var t=$(e.target);t.text()=="\u5207\u6362\u5230\u82f1\u6587\u9605\u8bfb"?(t.text("\u5207\u6362\u5230\u4e2d\u6587\u9605\u8bfb"),$(".original").show(),$(".translation").hide()):(t.text("\u5207\u6362\u5230\u82f1\u6587\u9605\u8bfb"),$(".original").hide(),$(".translation").show())})},function(e,t){"use strict";t.__esModule=!0,t["default"]={init:function(t,n){this.moreMenuBtn=$(".js-more-menu-btn"),this.moreMenu=$("#doc-hd .more-menu"),n===undefined&&(n=$(".top-menu")),this.dom=n,this.trigger=t},run:function(){var t=this,n=100,r=undefined;this.trigger.on("click",function(e){e.preventDefault(),clearInterval(r),t.dom.fadeIn()}),this.moreMenuBtn.on("click",function(e){e.preventDefault(),t.moreMenu.fadeIn()}),$(document).on("click",function(e){e.target!==t.trigger[0]&&e.target!==t.dom[0]&&t.dom.fadeOut(),e.target!==t.moreMenuBtn[0]&&e.target!==t.moreMenu[0]&&t.moreMenu.fadeOut()}),this.dom.hover(function(e){clearInterval(r)},function(){r=setTimeout(function(){t.dom.fadeOut()},n)})}},e.exports=t["default"]},function(e,t){"use strict";e.exports={getInfo:function(){return $.ajax({url:"/user/userinfo"})}}},function(e,t){"use strict";t.__esModule=!0,t["default"]={init:function(){$("body").append('<a href="#" class="elevator" title="\u8fd4\u56de\u9876\u90e8"></a>'),this.bindEvent()},bindEvent:function(){$("body").delegate(".elevator","click",function(e){e.preventDefault(),$("html, body").animate({scrollTop:0},500)}),$(window).on("scroll",function(){var e=$(".elevator"),t=$(this).scrollTop();t<1e3&&e.hide(),t>=1e3&&e.show()})}},e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}t.__esModule=!0;var s=n(5),o=r(s),u=function(){function e(t,n,r){var s=arguments.length<=3||arguments[3]===undefined?[]:arguments[3],o=arguments.length<=4||arguments[4]===undefined?"/praise/":arguments[4];i(this,e),this.likeList=$(t),this.capabilityClass=n,this.likeUrl=o,this.needLogin=r,this.addOne=function(){var e=$('<i class="red" style="display:none;position:absolute;font-weight:bold;">+1</i>');return $("body").append(e),e}();var u=this;n.invalid&&this.likeList.toArray().forEach(function(e){var t=$(e).attr("data-article-id");s.indexOf(t)!==-1&&$(e).addClass(u.capabilityClass.invalid)}),this.installUi()}return e.prototype.addOneAnim=function(t){var n=t.offset();this.addOne.css({top:n.top+20+"px",left:n.left+45+"px"}),this.addOne.show().animate({opacity:1,top:n.top+"px"}).animate({opacity:0,top:n.top-20+"px"});var r=t.find(".js-like-num"),i=parseInt($.trim(r.html()),10);r.fadeOut(function(){r.html(i+1),r.fadeIn()})},e.prototype.installUi=function(){var t=this;this.likeList.on("click",function(e){e.preventDefault();var n=$(this);if(n.hasClass("disabled"))return;var r=n.attr("data-article-id"),i=n.attr("data-article-type"),s=n.attr("data-article-owner"),u=function(){$.ajax({url:t.likeUrl,data:"article_id="+r+"&article_type="+i+"&article_owner="+s,method:"get"}).then(function(e){e.errno==0&&(t.capabilityClass.valid&&n.removeClass(t.capabilityClass.valid),t.capabilityClass.invalid&&(n.addClass(t.capabilityClass.invalid),$(".txt-up").text("\u9876\u8fc7\u5566")),t.addOneAnim(n))})};t.needLogin?o["default"].dealWithLogin().then(function(e){if(e=="succ"){var t=$("#doc-hd .avatar"),n=t.attr("src"),r=t.parent().attr("href"),i=$(".claim-meta .avatar-cell"),s=$(".claim-meta .blank-cell");if(i[0]){!$(".praised-count")[0]&&i.children("a").length==3&&(i.children("a:last").remove(),i.children("a:last").after(" \u7b49 4 \u4eba"));if($(".praised-count")[0]){var o=Number($(".praised-count").text());i.children("a:last").remove(),$(".claim-meta .avatar-cell .txt").html(" \u7b49 "+(o+1)+" \u4eba \u89c9\u5f97\u8fd9\u7bc7\u6587\u7ae0\u5f88\u8d5e")}i.children("a:first").before('<a href="'+r+'" class="avatar" target="_blank"><img src="'+n+'" /></a> ')}else s.html('<a href="'+r+'" class="avatar" target="_blank"><img src="'+n+'" /></a> \u89c9\u5f97\u8fd9\u7bc7\u6587\u7ae0\u5f88\u8d5e');u()}else layer.msg("\u60a8\u6ca1\u6709\u767b\u5f55\uff0c\u8bf7\u767b\u5f55\u540e\u518d\u8bd5\uff01"),setTimeout(function(){location.href="/user/loginpage"},1e3)}):u()})},e}();t["default"]=u,e.exports=t["default"]},function(e,t,n){"use strict";function r(e){return e&&e.__esModule?e:{"default":e}}var i=n(2),s=r(i);e.exports={dealWithLogin:function(){return s["default"].getInfo().then(function(e){return e.errno!=0?"not-login":"succ"})}}}])